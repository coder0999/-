<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>إنشاء امتحان</title>
    <!-- تضمين Tailwind CSS و Font Awesome -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');
        body {
            font-family: 'Cairo', sans-serif;
            direction: rtl;
            background-color: #f3f4f6;
        }
        /* تصميم للمربع الحواري المخصص */
        .custom-alert-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .custom-alert-box {
            background-color: white;
            padding: 2rem;
            border-radius: 0.75rem;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">
    <!-- المربع الحواري المخصص -->
    <div id="custom-alert-overlay" class="custom-alert-overlay hidden">
        <div class="custom-alert-box">
            <p id="custom-alert-message" class="text-xl text-gray-700"></p>
            <button id="custom-alert-close" class="mt-4 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">إغلاق</button>
        </div>
    </div>

    <!-- شاشة تسجيل الدخول -->
    <div id="login-page" class="flex-grow flex items-center justify-center p-4 transition-opacity duration-300">
        <div class="text-center bg-white p-8 rounded-xl shadow-lg w-full max-w-sm">
            <h1 class="text-2xl font-bold mb-6 text-gray-800">مرحباً بك!</h1>
            <button id="google-signin-btn" class="w-full bg-blue-600 text-white py-3 rounded-lg flex items-center justify-center hover:bg-blue-700 transition-colors">
                <i class="fab fa-google text-xl ml-3"></i>
                تسجيل الدخول باستخدام جوجل
            </button>
        </div>
    </div>

    <!-- المحتوى الرئيسي للتطبيق -->
    <div id="main-content" class="hidden flex-grow flex flex-col transition-opacity duration-300">
        <!-- شريط علوي (Header) -->
        <header class="bg-white shadow-md p-4 flex items-center justify-between z-10">
            <div class="flex items-center">
                <img id="user-photo" src="" alt="صورة المستخدم" class="h-10 w-10 rounded-full ml-3 hidden">
                <span id="user-name" class="text-gray-800 font-bold text-lg hidden"></span>
            </div>
            <h1 id="header-title" class="text-2xl font-bold text-gray-800 absolute left-1/2 transform -translate-x-1/2">إنشاء امتحان</h1>
            <div class="flex items-center">
                <button id="signout-btn" class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors mr-2 hidden">تسجيل الخروج</button>
                <a id="profile-link" href="#" class="text-gray-600 hover:text-gray-900 transition-colors">
                    <i class="fas fa-user-circle text-3xl"></i>
                </a>
            </div>
        </header>

        <!-- المحتوى الخاص بكل صفحة -->
        <main class="flex-grow p-4 pb-20 overflow-auto">
            <!-- صفحة إنشاء امتحان -->
            <div id="exams-page" class="page-content">
                <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                    <h2 class="text-xl font-bold mb-4 text-gray-800">أنواع الامتحانات</h2>
                    <div class="flex space-x-4">
                        <button id="manual-exam-btn" class="bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 transition-colors">يدوي</button>
                        <button id="ai-exam-btn" class="bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors">بالذكاء الاصطناعي (قريباً)</button>
                    </div>
                </div>

                <!-- قسم الامتحان اليدوي -->
                <div id="manual-exam-content" class="exam-content">
                    <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                        <h2 class="text-xl font-bold mb-4 text-gray-800">إنشاء امتحان يدوي</h2>
                        <div class="mb-4">
                            <label for="exam-title" class="block text-gray-700 font-bold mb-2">عنوان الامتحان</label>
                            <input type="text" id="exam-title" placeholder="أدخل عنوان الامتحان" class="w-full p-3 border rounded-lg text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="mb-4">
                            <label for="default-points" class="block text-gray-700 font-bold mb-2">النقاط الافتراضية لكل سؤال</label>
                            <input type="number" id="default-points" value="0" min="0" class="w-full p-3 border rounded-lg text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div id="question-list">
                            <!-- الأسئلة ستضاف هنا ديناميكياً -->
                        </div>
                        <button id="add-question-btn" class="w-full bg-green-500 text-white py-3 rounded-lg mt-4 hover:bg-green-600 transition-colors">
                            <i class="fas fa-plus ml-2"></i>إضافة سؤال
                        </button>
                        <button id="publish-exam-btn" class="w-full bg-blue-600 text-white py-3 rounded-lg mt-4 hover:bg-blue-700 transition-colors">نشر الامتحان</button>
                    </div>
                </div>

                <!-- قسم الامتحانات المنشورة -->
                <div id="published-exams-page" class="page-content hidden">
                    <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                        <h2 class="text-xl font-bold mb-4 text-gray-800">امتحاناتي المنشورة</h2>
                        <div id="published-exams-list">
                            <!-- الامتحانات المنشورة ستظهر هنا -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- صفحة الملف الشخصي -->
            <div id="profile-page" class="page-content hidden">
                <div class="bg-white rounded-xl shadow-lg p-6 text-center">
                    <img id="profile-photo" src="" alt="صورة المستخدم" class="h-24 w-24 rounded-full mx-auto mb-4">
                    <h2 id="profile-name" class="text-2xl font-bold text-gray-800"></h2>
                    <p id="profile-email" class="text-gray-600 mt-2"></p>
                </div>
            </div>
        </main>

        <!-- شريط التنقل السفلي -->
        <nav id="bottom-nav" class="fixed bottom-0 left-0 w-full bg-white shadow-lg p-3 flex justify-around transition-opacity duration-300 hidden">
            <button id="exams-nav-btn" class="text-gray-600 hover:text-blue-500 transition-colors focus:outline-none">
                <i class="fas fa-edit text-2xl"></i>
                <span class="block text-sm mt-1">امتحانات</span>
            </button>
            <button id="published-nav-btn" class="text-gray-600 hover:text-blue-500 transition-colors focus:outline-none">
                <i class="fas fa-list text-2xl"></i>
                <span class="block text-sm mt-1">منشوراتي</span>
            </button>
            <button id="profile-nav-btn" class="text-gray-600 hover:text-blue-500 transition-colors focus:outline-none">
                <i class="fas fa-user text-2xl"></i>
                <span class="block text-sm mt-1">ملف شخصي</span>
            </button>
        </nav>
    </div>

    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, collection, addDoc, getDocs, onSnapshot, query, where, deleteDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Global variables for Firebase config
        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const googleProvider = new GoogleAuthProvider();

        let userId = null;
        let questions = [];

        // عناصر الواجهة
        const loginPage = document.getElementById('login-page');
        const mainContent = document.getElementById('main-content');
        const googleSigninBtn = document.getElementById('google-signin-btn');
        const signoutBtn = document.getElementById('signout-btn');
        const userName = document.getElementById('user-name');
        const userPhoto = document.getElementById('user-photo');
        const bottomNav = document.getElementById('bottom-nav');
        const examsPage = document.getElementById('exams-page');
        const publishedExamsPage = document.getElementById('published-exams-page');
        const profilePage = document.getElementById('profile-page');
        const headerTitle = document.getElementById('header-title');
        const profileName = document.getElementById('profile-name');
        const profileEmail = document.getElementById('profile-email');
        const profilePhoto = document.getElementById('profile-photo');
        const examsNavBtn = document.getElementById('exams-nav-btn');
        const publishedNavBtn = document.getElementById('published-nav-btn');
        const profileNavBtn = document.getElementById('profile-nav-btn');
        const manualExamBtn = document.getElementById('manual-exam-btn');
        const aiExamBtn = document.getElementById('ai-exam-btn');
        const manualExamContent = document.getElementById('manual-exam-content');
        const examTitleInput = document.getElementById('exam-title');
        const defaultPointsInput = document.getElementById('default-points'); // إضافة عنصر النقاط الافتراضية
        const questionList = document.getElementById('question-list');
        const addQuestionBtn = document.getElementById('add-question-btn');
        const publishExamBtn = document.getElementById('publish-exam-btn');
        const publishedExamsList = document.getElementById('published-exams-list');
        const customAlertOverlay = document.getElementById('custom-alert-overlay');
        const customAlertMessage = document.getElementById('custom-alert-message');
        const customAlertCloseBtn = document.getElementById('custom-alert-close');
        
        // إظهار مربع حوار مخصص
        function showCustomAlert(message) {
            customAlertMessage.textContent = message;
            customAlertOverlay.classList.remove('hidden');
        }

        // إخفاء مربع حوار مخصص
        customAlertCloseBtn.addEventListener('click', () => {
            customAlertOverlay.classList.add('hidden');
        });

        // التبديل بين الصفحات
        function showPage(pageId) {
            document.querySelectorAll('.page-content').forEach(page => page.classList.add('hidden'));
            document.getElementById(pageId).classList.remove('hidden');
            let title = '';
            if (pageId === 'exams-page') title = 'إنشاء امتحان';
            else if (pageId === 'published-exams-page') title = 'امتحاناتي المنشورة';
            else if (pageId === 'profile-page') title = 'الملف الشخصي';
            headerTitle.textContent = title;
        }

        // التبديل بين محتوى الامتحان (يدوي/آلي)
        function showExamContent(type) {
            document.querySelectorAll('.exam-content').forEach(content => content.classList.add('hidden'));
            if (type === 'manual') manualExamContent.classList.remove('hidden');
        }

        // وظيفة لمزامنة نقاط الأسئلة
        function syncPoints(newValue) {
            document.querySelectorAll('.points-input').forEach(input => {
                input.value = newValue;
            });
        }
        
        // إضافة سؤال جديد
        function addQuestion() {
            const questionId = questions.length;
            const newQuestion = {
                id: questionId,
                text: '',
                points: parseFloat(defaultPointsInput.value) || 0, // استخدام القيمة من الحقل الافتراضي
                options: ['', '', '', ''],
                correctOptionIndex: 0
            };
            questions.push(newQuestion);

            const questionDiv = document.createElement('div');
            questionDiv.className = 'bg-gray-50 rounded-xl p-4 shadow-md mb-4';
            questionDiv.dataset.id = questionId;

            const questionHeader = document.createElement('div');
            questionHeader.className = 'flex justify-between items-center mb-4';
            questionHeader.innerHTML = `
                <h4 class="text-lg font-bold text-gray-700">سؤال ${questionId + 1}</h4>
                <button class="remove-question-btn text-red-500 hover:text-red-700 transition-colors" data-id="${questionId}">
                    <i class="fas fa-trash-alt"></i>
                </button>
            `;
            
            const questionTextInput = document.createElement('textarea');
            questionTextInput.className = 'w-full p-2 border rounded-lg text-gray-700 resize-none focus:outline-none focus:ring-2 focus:ring-blue-500';
            questionTextInput.rows = 2;
            questionTextInput.placeholder = 'أدخل نص السؤال';
            questionTextInput.addEventListener('input', (e) => {
                questions[questionId].text = e.target.value;
            });

            const optionsDiv = document.createElement('div');
            optionsDiv.className = 'mt-4';

            newQuestion.options.forEach((option, optionIndex) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'flex items-center mb-2';

                const radioInput = document.createElement('input');
                radioInput.type = 'radio';
                radioInput.name = `correct-option-${questionId}`;
                radioInput.id = `option-${questionId}-${optionIndex}`;
                radioInput.checked = optionIndex === newQuestion.correctOptionIndex;
                radioInput.className = 'ml-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300';
                radioInput.addEventListener('change', () => {
                    questions[questionId].correctOptionIndex = optionIndex;
                });

                const optionTextInput = document.createElement('input');
                optionTextInput.type = 'text';
                optionTextInput.className = 'w-full p-2 border rounded-lg text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500';
                optionTextInput.placeholder = `خيار ${optionIndex + 1}`;
                optionTextInput.value = option;
                optionTextInput.addEventListener('input', (e) => {
                    questions[questionId].options[optionIndex] = e.target.value;
                });

                const label = document.createElement('label');
                label.htmlFor = `option-${questionId}-${optionIndex}`;
                label.className = 'flex-grow text-gray-700 cursor-pointer';
                label.appendChild(optionTextInput);

                optionDiv.appendChild(radioInput);
                optionDiv.appendChild(label);
                optionsDiv.appendChild(optionDiv);
            });

            const pointsDiv = document.createElement('div');
            pointsDiv.className = 'flex items-center mt-4';
            
            const pointsLabel = document.createElement('label');
            pointsLabel.textContent = 'النقاط:';
            pointsLabel.className = 'text-gray-700 font-bold ml-2';

            const pointsInput = document.createElement('input');
            pointsInput.type = 'number';
            pointsInput.value = newQuestion.points; // تعيين القيمة الافتراضية
            pointsInput.min = '0';
            pointsInput.className = 'w-1/4 p-2 border rounded-lg text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 points-input'; // إضافة الكلاس لتسهيل التحديد
            
            // إضافة مستمع للأحداث لتغيير قيمة النقاط لجميع الأسئلة
            pointsInput.addEventListener('input', (e) => {
                questions.forEach(q => q.points = parseFloat(e.target.value) || 0);
                syncPoints(e.target.value);
            });

            pointsDiv.appendChild(pointsLabel);
            pointsDiv.appendChild(pointsInput);

            questionDiv.appendChild(questionHeader);
            questionDiv.appendChild(questionTextInput);
            questionDiv.appendChild(optionsDiv);
            questionDiv.appendChild(pointsDiv);
            questionList.appendChild(questionDiv);
        }

        // إزالة سؤال
        questionList.addEventListener('click', (e) => {
            if (e.target.closest('.remove-question-btn')) {
                const button = e.target.closest('.remove-question-btn');
                const questionIdToRemove = parseInt(button.dataset.id, 10);
                questions.splice(questionIdToRemove, 1);
                
                // إعادة رسم الأسئلة لتحديث الأرقام
                renderQuestions();
            }
        });

        // إعادة رسم قائمة الأسئلة بالكامل
        function renderQuestions() {
            questionList.innerHTML = '';
            questions.forEach((q, index) => {
                q.id = index;
                const questionDiv = document.createElement('div');
                questionDiv.className = 'bg-gray-50 rounded-xl p-4 shadow-md mb-4';
                questionDiv.dataset.id = index;

                const questionHeader = document.createElement('div');
                questionHeader.className = 'flex justify-between items-center mb-4';
                questionHeader.innerHTML = `
                    <h4 class="text-lg font-bold text-gray-700">سؤال ${index + 1}</h4>
                    <button class="remove-question-btn text-red-500 hover:text-red-700 transition-colors" data-id="${index}">
                        <i class="fas fa-trash-alt"></i>
                    </button>
                `;
                
                const questionTextInput = document.createElement('textarea');
                questionTextInput.className = 'w-full p-2 border rounded-lg text-gray-700 resize-none focus:outline-none focus:ring-2 focus:ring-blue-500';
                questionTextInput.rows = 2;
                questionTextInput.placeholder = 'أدخل نص السؤال';
                questionTextInput.value = q.text;
                questionTextInput.addEventListener('input', (e) => {
                    questions[index].text = e.target.value;
                });

                const optionsDiv = document.createElement('div');
                optionsDiv.className = 'mt-4';

                q.options.forEach((option, optionIndex) => {
                    const optionDiv = document.createElement('div');
                    optionDiv.className = 'flex items-center mb-2';

                    const radioInput = document.createElement('input');
                    radioInput.type = 'radio';
                    radioInput.name = `correct-option-${index}`;
                    radioInput.id = `option-${index}-${optionIndex}`;
                    radioInput.checked = optionIndex === q.correctOptionIndex;
                    radioInput.className = 'ml-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300';
                    radioInput.addEventListener('change', () => {
                        questions[index].correctOptionIndex = optionIndex;
                    });

                    const optionTextInput = document.createElement('input');
                    optionTextInput.type = 'text';
                    optionTextInput.className = 'w-full p-2 border rounded-lg text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500';
                    optionTextInput.placeholder = `خيار ${optionIndex + 1}`;
                    optionTextInput.value = option;
                    optionTextInput.addEventListener('input', (e) => {
                        questions[index].options[optionIndex] = e.target.value;
                    });

                    const label = document.createElement('label');
                    label.htmlFor = `option-${index}-${optionIndex}`;
                    label.className = 'flex-grow text-gray-700 cursor-pointer';
                    label.appendChild(optionTextInput);

                    optionDiv.appendChild(radioInput);
                    optionDiv.appendChild(label);
                    optionsDiv.appendChild(optionDiv);
                });

                const pointsDiv = document.createElement('div');
                pointsDiv.className = 'flex items-center mt-4';
                
                const pointsLabel = document.createElement('label');
                pointsLabel.textContent = 'النقاط:';
                pointsLabel.className = 'text-gray-700 font-bold ml-2';

                const pointsInput = document.createElement('input');
                pointsInput.type = 'number';
                pointsInput.value = q.points;
                pointsInput.min = '0';
                pointsInput.className = 'w-1/4 p-2 border rounded-lg text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 points-input';
                
                pointsInput.addEventListener('input', (e) => {
                    questions.forEach(q => q.points = parseFloat(e.target.value) || 0);
                    syncPoints(e.target.value);
                });

                pointsDiv.appendChild(pointsLabel);
                pointsDiv.appendChild(pointsInput);

                questionDiv.appendChild(questionHeader);
                questionDiv.appendChild(questionTextInput);
                questionDiv.appendChild(optionsDiv);
                questionDiv.appendChild(pointsDiv);
                questionList.appendChild(questionDiv);
            });
        }
        
        // نشر الامتحان
        async function publishExam() {
            if (!userId) {
                showCustomAlert('يجب أن تكون مسجلاً للدخول لنشر امتحان.');
                return;
            }

            if (questions.length === 0) {
                showCustomAlert('يجب إضافة سؤال واحد على الأقل.');
                return;
            }

            const examTitle = examTitleInput.value.trim();
            if (examTitle === '') {
                showCustomAlert('الرجاء إدخال عنوان للامتحان.');
                return;
            }

            const examData = {
                title: examTitle,
                questions: questions.map(q => ({
                    text: q.text,
                    points: q.points,
                    options: q.options,
                    correctOptionIndex: q.correctOptionIndex
                })),
                creatorId: userId,
                createdAt: new Date()
            };

            const collectionPath = `/artifacts/${appId}/public/data/exams`;
            try {
                const docRef = await addDoc(collection(db, collectionPath), examData);
                showCustomAlert('تم نشر الامتحان بنجاح!');
                // إعادة تعيين النموذج بعد النشر
                examTitleInput.value = '';
                questions = [];
                questionList.innerHTML = '';
            } catch (err) {
                console.error("Error adding document: ", err);
                showCustomAlert('فشل نشر الامتحان.');
            }
        }

        // عرض الامتحانات المنشورة
        function renderPublishedExams() {
            if (!userId) return;
            const examsCollection = collection(db, `/artifacts/${appId}/public/data/exams`);
            const q = query(examsCollection, where("creatorId", "==", userId));

            onSnapshot(q, (snapshot) => {
                publishedExamsList.innerHTML = '';
                snapshot.forEach((doc) => {
                    const exam = doc.data();
                    const examId = doc.id;
                    const examCard = document.createElement('div');
                    examCard.className = 'bg-gray-50 rounded-xl p-4 shadow-md mb-4 flex justify-between items-center';
                    examCard.innerHTML = `
                        <h4 class="text-lg font-bold text-gray-700">${exam.title}</h4>
                        <button class="delete-exam-btn text-red-500 hover:text-red-700 transition-colors" data-id="${examId}">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    `;
                    publishedExamsList.appendChild(examCard);
                });
            });
        }

        // حذف امتحان
        publishedExamsList.addEventListener('click', async (e) => {
            if (e.target.closest('.delete-exam-btn')) {
                const button = e.target.closest('.delete-exam-btn');
                const examIdToDelete = button.dataset.id;
                
                try {
                    await deleteDoc(doc(db, `/artifacts/${appId}/public/data/exams/${examIdToDelete}`));
                    showCustomAlert('تم حذف الامتحان بنجاح.');
                } catch (err) {
                    console.error("Error removing document: ", err);
                    showCustomAlert('فشل حذف الامتحان.');
                }
            }
        });

        // المستمعين للأحداث
        examsNavBtn.addEventListener('click', () => showPage('exams-page'));
        publishedNavBtn.addEventListener('click', () => {
            showPage('published-exams-page');
            renderPublishedExams();
        });
        profileNavBtn.addEventListener('click', () => showPage('profile-page'));

        manualExamBtn.addEventListener('click', () => showExamContent('manual'));
        aiExamBtn.addEventListener('click', () => showCustomAlert('قريباً... هذه الميزة تحت التطوير!'));

        googleSigninBtn.addEventListener('click', () => signInWithPopup(auth, googleProvider).catch(err => showCustomAlert('فشل تسجيل الدخول.')));
        signoutBtn.addEventListener('click', () => signOut(auth).catch(err => showCustomAlert('فشل تسجيل الخروج.')));
        
        onAuthStateChanged(auth, (user) => {
            if (user) {
                userId = user.uid;
                loginPage.classList.add('hidden');
                mainContent.classList.remove('hidden');
                bottomNav.classList.remove('hidden');
                userName.textContent = user.displayName;
                userPhoto.src = user.photoURL;
                userPhoto.classList.remove('hidden');
                userName.classList.remove('hidden');
                signoutBtn.classList.remove('hidden');
                profileName.textContent = user.displayName;
                profileEmail.textContent = user.email;
                profilePhoto.src = user.photoURL;
                showPage('exams-page');
                showExamContent('manual');
                renderPublishedExams();
                
                // تحديث النقاط الافتراضية
                defaultPointsInput.value = '0';
                
                if (questions.length === 0) addQuestion();
            } else {
                userId = null;
                loginPage.classList.remove('hidden');
                mainContent.classList.add('hidden');
                bottomNav.classList.add('hidden');
                questions = [];
                questionList.innerHTML = '';
                publishedExamsList.innerHTML = '';
            }
        });
        
        // مستمع حدث لتغيير قيمة النقاط الافتراضية
        defaultPointsInput.addEventListener('input', (e) => {
            const newValue = e.target.value;
            questions.forEach(q => q.points = parseFloat(newValue) || 0);
            syncPoints(newValue);
        });

        addQuestionBtn.addEventListener('click', addQuestion);
        publishExamBtn.addEventListener('click', publishExam);

    </script>
</body>
</html>
